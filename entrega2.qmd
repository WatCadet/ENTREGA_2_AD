---
title: "ENTREGA 2 Análisis de Datos"
format: html
author: 
  - Carlos Aliño
  - Dídac Capó
  - Irene Rodríguez
---

[Enlace al repositorio de Github](https://github.com/WatCadet/ENTREGA_2_AD)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(readr)
```

Análisis de las respuestas a la encuesta sobre salud vocal. 

El investigador David Corvacho, especialista en Medicina del Trabajo, presenta la encuesta que ha diseñado para responder a los objetivos de su estudio sobre salud vocal.

Hacemos una lectura y limpieza de los datos. Describimos los datos y presentamos los objetivos de estudio. Analizamos los datos, mostrando las medidas y gráficos que permitan responder a las preguntas planteadas por el investigador, y obtenemos conclusiones.

## Lectura y limpieza de los datos

Leemos los datos. Intenamos crear una columna nueva SCORE que nos de la calidad.

```{r, echo= FALSE, message=FALSE}
data_saludvocal <- read_csv2(file = "Salut_Vocal_anonimizada.csv")

var = data_saludvocal$`Em sent desplaçat de les converses per la meva veu`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`Em sent desplaçat de les converses per la meva veu` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La gent em pregunta: què et passa amb la veu?`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La gent em pregunta: què et passa amb la veu?` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La meva veu em fa sentir certa minusvalidesa`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La meva veu em fa sentir certa minusvalidesa` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La meva veu em molesta`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La meva veu em molesta` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La gent em sent amb dificultat a causa de la meva veu`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La gent em sent amb dificultat a causa de la meva veu` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`El meu problema amb la veu afecta el rendiment laboral`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`El meu problema amb la veu afecta el rendiment laboral` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`Not que necessit tensar la gola (gargamella) per produir la veu`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`Not que necessit tensar la gola (gargamella) per produir la veu` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La qualitat de la meva veu és imprevisible`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La qualitat de la meva veu és imprevisible` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`La gent no m'entén en llocs sorollosos`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`La gent no m'entén en llocs sorollosos` = var %>% 
  as.numeric()
```


```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`Em sent desplaçat de les converses per la meva veu`
var = as.factor(var)
levels(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`Em sent desplaçat de les converses per la meva veu` = var 
```

```{r, echo= FALSE, message=FALSE}
var = data_saludvocal$`Els meus problemes amb la veu alteren la meva vida personal i social`
class(var)
```


```{r, echo= FALSE, message=FALSE}
var = as.factor(var)

var = as.factor(var, levels= c("Mai", "A vegades", "Gairebé mai", "A vegades", "Gairebé sempre"), labels = c(0,1,2,3,4))
#s(var) <- c("Mai" = 0, "A vegades" = 1, "Gairebé mai" = 2, "A vegades" = 3, "Gairebé sempre" = 4)
data_saludvocal$`Els meus problemes amb la veu alteren la meva vida personal i social` = var
```


Visualizamos el conjunto de datos. 

```{r}
data_saludvocal %>% 
  glimpse
```

```{r}
data_saludvocal <- data_saludvocal %>%
  mutate(SCORE = rowSums(select(., 28:38)))
data_saludvocal
```



## Descripción de los datos

Su dimensión es de 185 filas y 38 variables.

La descripción de las variables está en el pdf adjunto.

## Objetivos

1. Hacer la columna con la suma que indica la calidad.

2. Pregunta 4. ¿Qué factores influyen enuna mala calidad de voz?Café, tabaco, alcohol,bebidas con gas etc.

## Análisis

La pregunta 1 no hemos podido acabarla. La necesitamos para la 2.

La pregunta 2 se trata de comparar una variable cuantitativa y una cualitativa con 4 factores en repetidas ocasiones.


Cruzamos una variable cuantitativa (SCORE (columna resultante de la pregunta 1)) con una cualitativa (cafe, tabaco, alcholo, bebidas con gas). Usamos boxplot. El codigo del grafico seria de la siguente manera.

```{r, eval = FALSE}
ggplot(data, aes(x = cafe, y = SCORE)) +
  theme_bw() + 
  geom_boxplot(aes(color = cafe), width = 0.3, 
               show.legend = FALSE) + 
  geom_jitter(aes(color = cafe), alpha = 0.5, 
              show.legend = FALSE, 
              position = position_jitter(width = 0.2, seed = 0)) + 
  scale_color_manual(values = c("magenta3","darkgreen","orange", "pink", "lightblue")) + 
  labs(x = "Consum de cafe", y = "SCORE (calidad)") 
```

Repetiriamos un proceso análogo en el resto de casos (tabaco, bebidas con gas, ...)

## Conclusiones
